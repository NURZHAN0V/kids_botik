from –∏–≥—Ä—ã.–≤–∏—Å–µ–ª–∏—Ü–∞ import —Ñ—É–Ω–∫—Ü–∏—è_–≤–∏—Å–µ–ª–∏—Ü–∞
from –∏–≥—Ä—ã.—É–≥–∞–¥–∞–π–∫–∞ import —Ñ—É–Ω–∫—Ü–∏—è_—É–≥–∞–¥–∞–π–∫–∞
from –∏–≥—Ä—ã.–º–æ—Ä—Å–∫–æ–π–±–æ–π import —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–º–æ—Ä—Å–∫–æ–π_–±–æ–π, —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–º–æ—Ä—Å–∫–æ–π_–±–æ–π, –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–º–æ—Ä—Å–∫–æ–π_–±–æ–π
from –∏–≥—Ä—ã.—Ç—Ä–∏–≤—Ä—è–¥ import (
    —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—Ç—Ä–∏_–≤_—Ä—è–¥, —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥, –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_—Ç—Ä–∏_–≤_—Ä—è–¥, 
    –æ–±–º–µ–Ω_–∫–ª–µ—Ç–æ–∫, —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã, —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, 
    –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–¥–æ—Å—Ç—É–ø–Ω—ã–µ_—Ö–æ–¥—ã, –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∞—Ç—å_–ø–æ–ª–µ, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å_—Ä–µ–∑—É–ª—å—Ç–∞—Ç_–≤_–±–¥,
    –ø–æ–ª—É—á–∏—Ç—å_—Ç–∞–±–ª–∏—Ü—É_–ª–∏–¥–µ—Ä–æ–≤, –ø–æ–ª—É—á–∏—Ç—å_–ø–æ–∑–∏—Ü–∏—é_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Ç–∞–±–ª–∏—Ü—ã_–ª–∏–¥–µ—Ä–æ–≤
)
from typing import Optional
from –∏–≥—Ä—ã.–∫—Ä–µ—Å—Ç–∏–∫–∏–Ω–æ–ª–∏–∫–∏ import —Ñ—É–Ω–∫—Ü–∏—è_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏
from –∏–≥—Ä—ã.–¥–∏–Ω–æ import —Ñ—É–Ω–∫—Ü–∏—è_–¥–∏–Ω–æ

# –ò–º–ø–æ—Ä—Ç—ã –¥–ª—è Telegram –±–æ—Ç–∞
try:
    import telebot
    from config import TELEGRAM_BOT_TOKEN, ONLY_TELEGRAM
    telegram_available = True
except ImportError:
    telegram_available = False
    TELEGRAM_BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    ONLY_TELEGRAM = None
    print("‚ö†Ô∏è –î–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install pyTelegramBotAPI")
except:
    telegram_available = False
    TELEGRAM_BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"
    ONLY_TELEGRAM = None
    print("‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ config.py")

# –°–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä –¥–ª—è Telegram –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞ = {}
–∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞ = {}
–∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π = {}
–∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏ = {}
–∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥ = {}

def —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, —É—Ä–æ–≤–µ–Ω—å):
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã –≤–∏—Å–µ–ª–∏—Ü–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    import random
    —Å–ª–æ–≤–∞ = {
        "–ª–µ–≥–∫–∏–π": ['–∫–æ—Ç', '–ø—ë—Å', '–¥–æ–º', '–ª–µ—Å', '—Å–≤–µ—Ç'],
        "—Å—Ä–µ–¥–Ω–∏–π": ['—Å—Ç–æ–ª', '–ª—É–Ω–∞', '—Ä–µ–∫–∞', '–Ω–æ—á—å', '—Ç–µ–Ω—å'],
        "—Å–ª–æ–∂–Ω—ã–π": ['–ø—Ä–∏–º–µ—Ä', '—É–ª—ã–±–∫–∞', '–∫–∞—Ä—Ç–∏–Ω–∞', '—Ä–µ—à–µ–Ω–∏–µ']
    }
    
    —Å–ª–æ–≤–æ = random.choice(—Å–ª–æ–≤–∞[—É—Ä–æ–≤–µ–Ω—å])
    –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id] = {
        '—Å–ª–æ–≤–æ': —Å–ª–æ–≤–æ,
        '—É–≥–∞–¥–∞–Ω–æ': ['_'] * len(—Å–ª–æ–≤–æ),
        '–ø–æ–ø—ã—Ç–∫–∏': 7 if —É—Ä–æ–≤–µ–Ω—å == "–ª–µ–≥–∫–∏–π" else 5 if —É—Ä–æ–≤–µ–Ω—å == "—Å—Ä–µ–¥–Ω–∏–π" else 3,
        '—É—Ä–æ–≤–µ–Ω—å': —É—Ä–æ–≤–µ–Ω—å
    }

def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, –±—É–∫–≤–∞):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞ –≤ –∏–≥—Ä–µ –≤–∏—Å–µ–ª–∏—Ü–∞"""
    –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
    —Å–ª–æ–≤–æ = –∏–≥—Ä–∞['—Å–ª–æ–≤–æ']
    —É–≥–∞–¥–∞–Ω–æ = –∏–≥—Ä–∞['—É–≥–∞–¥–∞–Ω–æ']
    
    if –±—É–∫–≤–∞ in —Å–ª–æ–≤–æ:
        for i in range(len(—Å–ª–æ–≤–æ)):
            if —Å–ª–æ–≤–æ[i] == –±—É–∫–≤–∞:
                —É–≥–∞–¥–∞–Ω–æ[i] = –±—É–∫–≤–∞
        —Ä–µ–∑—É–ª—å—Ç–∞—Ç = "‚úÖ –ï—Å—Ç—å —Ç–∞–∫–∞—è –±—É–∫–≤–∞!"
    else:
        –∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏'] -= 1
        —Ä–µ–∑—É–ª—å—Ç–∞—Ç = "‚ùå –ù–µ—Ç —Ç–∞–∫–æ–π –±—É–∫–≤—ã"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f"–°–ª–æ–≤–æ: {' '.join(—É–≥–∞–¥–∞–Ω–æ)}\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã
    if '_' not in —É–≥–∞–¥–∞–Ω–æ:
        del –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
        return f"{—Ä–µ–∑—É–ª—å—Ç–∞—Ç}\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\nüéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã —É–≥–∞–¥–∞–ª —Å–ª–æ–≤–æ: {—Å–ª–æ–≤–æ}!\n–ß—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –µ—â—ë, –Ω–∞–ø–∏—à–∏ '–≤–∏—Å–µ–ª–∏—Ü–∞'"
    elif –∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏'] <= 0:
        del –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
        return f"{—Ä–µ–∑—É–ª—å—Ç–∞—Ç}\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\nüíÄ –¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª. –°–ª–æ–≤–æ –±—ã–ª–æ: {—Å–ª–æ–≤–æ}\n–ß—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –µ—â—ë, –Ω–∞–ø–∏—à–∏ '–≤–∏—Å–µ–ª–∏—Ü–∞'"
    
    return f"{—Ä–µ–∑—É–ª—å—Ç–∞—Ç}\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\n–í–≤–µ–¥–∏ —Å–ª–µ–¥—É—é—â—É—é –±—É–∫–≤—É:"

def —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—É–≥–∞–¥–∞–π–∫–∞(user_id):
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã —É–≥–∞–¥–∞–π–∫–∞"""
    import random
    –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞[user_id] = {
        '—á–∏—Å–ª–æ': random.randint(1, 10),
        '–ø–æ–ø—ã—Ç–∫–∏': 0
    }

def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_—É–≥–∞–¥–∞–π–∫–∞(user_id, —á–∏—Å–ª–æ_str):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞ –≤ —É–≥–∞–¥–∞–π–∫–µ"""
    try:
        —á–∏—Å–ª–æ = int(—á–∏—Å–ª–æ_str)
        –∏–≥—Ä–∞ = –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞[user_id]
        –∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏'] += 1
        
        if —á–∏—Å–ª–æ == –∏–≥—Ä–∞['—á–∏—Å–ª–æ']:
            del –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞[user_id]
            return f"üéâ –ú–æ–ª–æ–¥–µ—Ü! –¢—ã —É–≥–∞–¥–∞–ª —Å {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']} –ø–æ–ø—ã—Ç–∫–∏!\n–ú–æ—ë —á–∏—Å–ª–æ: {–∏–≥—Ä–∞['—á–∏—Å–ª–æ']}\n–î–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã –Ω–∞–ø–∏—à–∏ '—É–≥–∞–¥–∞–π–∫–∞'"
        elif —á–∏—Å–ª–æ < –∏–≥—Ä–∞['—á–∏—Å–ª–æ']:
            return f"üìà –ú–æ—ë —á–∏—Å–ª–æ –±–æ–ª—å—à–µ! –ü–æ–ø—ã—Ç–∫–∞ {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}\n–í–≤–µ–¥–∏ —á–∏—Å–ª–æ:"
        else:
            return f"üìâ –ú–æ—ë —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ! –ü–æ–ø—ã—Ç–∫–∞ {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}\n–í–≤–µ–¥–∏ —á–∏—Å–ª–æ:"
    except:
        return "‚ö†Ô∏è –í–≤–µ–¥–∏ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10"



def —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(user_id):
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏"""
    –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id] = {
        '–ø–æ–ª–µ': [["‚¨ú" for _ in range(3)] for _ in range(3)],
        '—Ö–æ–¥—ã': 0
    }

def —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–ø–æ–ª–µ):
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∫—Ä–µ—Å—Ç–∏–∫–æ–≤-–Ω–æ–ª–∏–∫–æ–≤"""
    import telebot
    markup = telebot.types.InlineKeyboardMarkup(row_width=3)
    for i in range(3):
        row = []
        for j in range(3):
            —Å–∏–º–≤–æ–ª = –ø–æ–ª–µ[i][j]
            row.append(telebot.types.InlineKeyboardButton(—Å–∏–º–≤–æ–ª, callback_data=f"tic_{i}_{j}"))
        markup.row(*row)
    return markup

def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(user_id, x, y):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞ –≤ –∫—Ä–µ—Å—Ç–∏–∫–∞—Ö-–Ω–æ–ª–∏–∫–∞—Ö"""
    –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
    
    if –∏–≥—Ä–∞['–ø–æ–ª–µ'][x][y] != "‚¨ú":
        return None, "‚ö†Ô∏è –ö–ª–µ—Ç–∫–∞ –∑–∞–Ω—è—Ç–∞"
    
    # –•–æ–¥ –∏–≥—Ä–æ–∫–∞
    –∏–≥—Ä–∞['–ø–æ–ª–µ'][x][y] = "‚ùå"
    –∏–≥—Ä–∞['—Ö–æ–¥—ã'] += 1
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã –∏–≥—Ä–æ–∫–∞
    if –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–±–µ–¥—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–∏–≥—Ä–∞['–ø–æ–ª–µ'], "‚ùå"):
        del –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
        return None, "üéâ –¢—ã –ø–æ–±–µ–¥–∏–ª!\n–î–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã –Ω–∞–ø–∏—à–∏ '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏'"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—á—å–µ–π
    if –∏–≥—Ä–∞['—Ö–æ–¥—ã'] >= 9:
        del –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
        return None, "ü§ù –ù–∏—á—å—è!\n–î–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã –Ω–∞–ø–∏—à–∏ '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏'"
    
    # –•–æ–¥ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
    —Å–≤–æ–±–æ–¥–Ω—ã–µ = [(i, j) for i in range(3) for j in range(3) if –∏–≥—Ä–∞['–ø–æ–ª–µ'][i][j] == "‚¨ú"]
    if —Å–≤–æ–±–æ–¥–Ω—ã–µ:
        import random
        comp_x, comp_y = random.choice(—Å–≤–æ–±–æ–¥–Ω—ã–µ)
        –∏–≥—Ä–∞['–ø–æ–ª–µ'][comp_x][comp_y] = "‚≠ï"
        –∏–≥—Ä–∞['—Ö–æ–¥—ã'] += 1
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        if –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–±–µ–¥—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–∏–≥—Ä–∞['–ø–æ–ª–µ'], "‚≠ï"):
            del –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
            return None, "üíÄ –ü–æ–±–µ–¥–∏–ª –∫–æ–º–ø—å—é—Ç–µ—Ä\n–î–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã –Ω–∞–ø–∏—à–∏ '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏'"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—á—å–µ–π –ø–æ—Å–ª–µ —Ö–æ–¥–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        if –∏–≥—Ä–∞['—Ö–æ–¥—ã'] >= 9:
            del –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
            return None, "ü§ù –ù–∏—á—å—è!\n–î–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã –Ω–∞–ø–∏—à–∏ '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏'"
    
    markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
    return markup, "–¢–≤–æ–π —Ö–æ–¥:"

def –ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–±–µ–¥—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–ø–æ–ª–µ, —Å–∏–º–≤–æ–ª):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã –≤ –∫—Ä–µ—Å—Ç–∏–∫–∞—Ö-–Ω–æ–ª–∏–∫–∞—Ö"""
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–æ–∫
    for i in range(3):
        if all(–ø–æ–ª–µ[i][j] == —Å–∏–º–≤–æ–ª for j in range(3)):
            return True
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
    for j in range(3):
        if all(–ø–æ–ª–µ[i][j] == —Å–∏–º–≤–æ–ª for i in range(3)):
            return True
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–µ–π
    if all(–ø–æ–ª–µ[i][i] == —Å–∏–º–≤–æ–ª for i in range(3)):
        return True
    if all(–ø–æ–ª–µ[i][2-i] == —Å–∏–º–≤–æ–ª for i in range(3)):
        return True
    
    return False

def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(—Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç, –∑–∞–ø—É—Å—Ç–∏—Ç—å_–∏–≥—Ä—É=None):
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ –∏ Telegram"""
    —Å–æ–æ–±—â–µ–Ω–∏–µ = —Å–æ–æ–±—â–µ–Ω–∏–µ.strip().lower()

    if "–ø—Ä–∏–≤–µ—Ç" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –ü—Ä–∏–≤–µ—Ç! –†–∞–¥ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å üòä –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?")

    elif "–∫–∞–∫ –¥–µ–ª–∞" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —è –≤ —Ä–µ–∂–∏–º–µ –æ–Ω–ª–∞–π–Ω –∏ –≥–æ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å! –ê —É —Ç–µ–±—è?")

    elif "–∏–º—è" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –ú–µ–Ω—è –∑–æ–≤—É—Ç –ü–æ–º–æ—â–Ω–∏–∫. –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ üëÆ.")

    elif "—Å–ø–∞—Å–∏–±–æ" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å! üòä")

    elif "–ø–æ–∫–∞" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "–≤—ã—Ö–æ–¥" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –î–æ –≤—Å—Ç—Ä–µ—á–∏! –ù–∞–¥–µ—é—Å—å, —Ç–µ–±–µ –±—ã–ª–æ –≤–µ—Å–µ–ª–æ üòÑ")

    elif ("–≤–∏—Å–µ–ª–∏—Ü" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "—É–≥–∞–¥–∞–π" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "–º–æ—Ä—Å–∫–æ–π" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "–∫—Ä–µ—Å—Ç–∏–∫–∏" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "–¥–∏–Ω–æ" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "—Ç—Ä–∏" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "—Ä—è–¥" in —Å–æ–æ–±—â–µ–Ω–∏–µ) and –∑–∞–ø—É—Å—Ç–∏—Ç—å_–∏–≥—Ä—É is not None:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–≥—Ä –≤ Telegram
        if "–≤–∏—Å–µ–ª–∏—Ü" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "hangman_start"
        elif "—É–≥–∞–¥–∞–π" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "guess_start"
        elif "–º–æ—Ä—Å–∫–æ–π" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "sea_start"
        elif "–∫—Ä–µ—Å—Ç–∏–∫–∏" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "tic_start"
        elif "–¥–∏–Ω–æ" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "dino_start"
        elif "—Ç—Ä–∏" in —Å–æ–æ–±—â–µ–Ω–∏–µ or "—Ä—è–¥" in —Å–æ–æ–±—â–µ–Ω–∏–µ: return "match_start"

    elif "–∏–≥—Ä" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –û—Ç–ª–∏—á–Ω–æ! –Ø —É–º–µ—é –∏–≥—Ä–∞—Ç—å –≤:\n- –í–∏—Å–µ–ª–∏—Ü–∞ (–Ω–∞–ø–∏—à–∏ '–≤–∏—Å–µ–ª–∏—Ü–∞')\n- –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ (–Ω–∞–ø–∏—à–∏ '—É–≥–∞–¥–∞–π–∫–∞')\n- –ú–æ—Ä—Å–∫–æ–π –±–æ–π (–Ω–∞–ø–∏—à–∏ '–º–æ—Ä—Å–∫–æ–π –±–æ–π')\n- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ (–Ω–∞–ø–∏—à–∏ '–∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏')\n- –¢—Ä–∏ –≤ —Ä—è–¥ (–Ω–∞–ø–∏—à–∏ '—Ç—Ä–∏ –≤ —Ä—è–¥')\n- –î–∏–Ω–æ (–Ω–∞–ø–∏—à–∏ '–¥–∏–Ω–æ')")

    elif "–∞–Ω–µ–∫–¥–æ—Ç" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: ‚Äî –ß—Ç–æ —Å–∫–∞–∑–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –Ω–∞ —Å–≤–∏–¥–∞–Ω–∏–∏?\n‚Äî –£ –º–µ–Ω—è \"404: —á—É–≤—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ\".")

    elif "–ø–æ–≥–æ–¥–∞" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –Ø –Ω–µ —Å–ª–µ–∂—É –∑–∞ –ø–æ–≥–æ–¥–æ–π, –Ω–æ –¥—É–º–∞—é, —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ üòâ")

    elif "—É–º–µ–µ—à—å" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –Ø —É–º–µ—é –±–æ–ª—Ç–∞—Ç—å, —à—É—Ç–∏—Ç—å, –∏–≥—Ä–∞—Ç—å –∏ –Ω–µ–º–Ω–æ–≥–æ –¥—É–º–∞—Ç—å... –ù–æ –ø–æ–∫–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ üòÖ")

    elif "–ø–æ—á–µ–º—É" in —Å–æ–æ–±—â–µ–Ω–∏–µ:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –ü–æ—Ç–æ–º—É —á—Ç–æ –∫—Ç–æ-—Ç–æ –∫–æ–≥–¥–∞-—Ç–æ –Ω–∞–ø–∏—Å–∞–ª –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å—Ç–∏–ª –º–µ–Ω—è –≤ —ç—Ç–æ—Ç –º–∏—Ä ü§ñ")

    else:
        –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å... –î–∞–≤–∞–π –æ–±—Å—É–¥–∏–º —ç—Ç–æ –ø–æ-–¥—Ä—É–≥–æ–º—É?")



def –∑–∞–ø—É—Å—Ç–∏—Ç—å_–±–æ—Ç–∞():
    """–ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞"""
    if not telegram_available:
        print("‚ùå Telegram –±–æ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install pyTelegramBotAPI")
        return False
    
    if TELEGRAM_BOT_TOKEN == "YOUR_BOT_TOKEN_HERE":
        print("‚ùå –ù–∞—Å—Ç—Ä–æ–π—Ç–µ TELEGRAM_BOT_TOKEN –≤ —Ñ–∞–π–ª–µ config.py")
        return False
    
    bot = telebot.TeleBot(TELEGRAM_BOT_TOKEN)
    
    @bot.message_handler(commands=['start'])
    def send_welcome(message):
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
        from database import db
        db.save_user(
            message.from_user.id,
            username=message.from_user.username,
            first_name=message.from_user.first_name,
            last_name=message.from_user.last_name
        )
        
        import telebot
        markup = telebot.types.InlineKeyboardMarkup(row_width=2)
        
        # –ö–Ω–æ–ø–∫–∏ –∏–≥—Ä
        games_row1 = [
            telebot.types.InlineKeyboardButton("üéØ –í–∏—Å–µ–ª–∏—Ü–∞", callback_data="menu_hangman"),
            telebot.types.InlineKeyboardButton("üé≤ –£–≥–∞–¥–∞–π–∫–∞", callback_data="menu_guess")
        ]
        games_row2 = [
            telebot.types.InlineKeyboardButton("üö¢ –ú–æ—Ä—Å–∫–æ–π –±–æ–π", callback_data="menu_sea"),
            telebot.types.InlineKeyboardButton("‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏", callback_data="menu_tic")
        ]
        games_row3 = [
            telebot.types.InlineKeyboardButton("üéØ –¢—Ä–∏ –≤ —Ä—è–¥", callback_data="menu_match"),
            telebot.types.InlineKeyboardButton("ü¶ï –î–∏–Ω–æ", callback_data="menu_dino")
        ]
        
        # –ö–Ω–æ–ø–∫–∏ –æ–±—â–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        chat_row = [
            telebot.types.InlineKeyboardButton("üí¨ –ü–æ–±–æ–ª—Ç–∞—Ç—å", callback_data="menu_chat"),
            telebot.types.InlineKeyboardButton("üòÑ –ê–Ω–µ–∫–¥–æ—Ç", callback_data="menu_joke")
        ]
        
        # –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        stats_row = [
            telebot.types.InlineKeyboardButton("üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤", callback_data="menu_leaderboard"),
            telebot.types.InlineKeyboardButton("üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="menu_stats")
        ]
        
        markup.row(*games_row1)
        markup.row(*games_row2)
        markup.row(*games_row3)
        markup.row(*chat_row)
        markup.row(*stats_row)
        
        bot.reply_to(message, "üëã –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –∏ –∏–≥—Ä–æ–≤–æ–π –±–æ—Ç! üéÆ\n\n"
                              "üéØ –í—ã–±–µ—Ä–∏, —á–µ–º —Ö–æ—á–µ—à—å –∑–∞–Ω—è—Ç—å—Å—è:\n\n"
                              "üéÆ **–ò–≥—Ä—ã** - —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è\n"
                              "üí¨ **–û–±—â–µ–Ω–∏–µ** - –ø—Ä–æ—Å—Ç–æ –ø–æ–±–æ–ª—Ç–∞–µ–º\n"
                              "üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - —Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –∏ —Ç–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\n\n"
                              "–ß—Ç–æ –≤—ã–±–µ—Ä–µ—à—å?", reply_markup=markup)
    
    @bot.message_handler(commands=['menu'])
    def show_menu(message):
        import telebot
        markup = telebot.types.InlineKeyboardMarkup(row_width=2)
        
        # –ö–Ω–æ–ø–∫–∏ –∏–≥—Ä
        games_row1 = [
            telebot.types.InlineKeyboardButton("üéØ –í–∏—Å–µ–ª–∏—Ü–∞", callback_data="menu_hangman"),
            telebot.types.InlineKeyboardButton("üé≤ –£–≥–∞–¥–∞–π–∫–∞", callback_data="menu_guess")
        ]
        games_row2 = [
            telebot.types.InlineKeyboardButton("üö¢ –ú–æ—Ä—Å–∫–æ–π –±–æ–π", callback_data="menu_sea"),
            telebot.types.InlineKeyboardButton("‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏", callback_data="menu_tic")
        ]
        games_row3 = [
            telebot.types.InlineKeyboardButton("üéØ –¢—Ä–∏ –≤ —Ä—è–¥", callback_data="menu_match"),
            telebot.types.InlineKeyboardButton("ü¶ï –î–∏–Ω–æ", callback_data="menu_dino")
        ]
        
        # –ö–Ω–æ–ø–∫–∏ –æ–±—â–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        chat_row = [
            telebot.types.InlineKeyboardButton("üí¨ –ü–æ–±–æ–ª—Ç–∞—Ç—å", callback_data="menu_chat"),
            telebot.types.InlineKeyboardButton("üòÑ –ê–Ω–µ–∫–¥–æ—Ç", callback_data="menu_joke")
        ]
        
        # –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        stats_row = [
            telebot.types.InlineKeyboardButton("üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤", callback_data="menu_leaderboard"),
            telebot.types.InlineKeyboardButton("üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="menu_stats")
        ]
        
        markup.row(*games_row1)
        markup.row(*games_row2)
        markup.row(*games_row3)
        markup.row(*chat_row)
        markup.row(*stats_row)
        
        bot.reply_to(message, "üéÆ **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**\n\n"
                              "–í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=markup)
    
    @bot.message_handler(func=lambda message: True)
    def echo_all(message):
        user_id = message.from_user.id
        —Ç–µ–∫—Å—Ç = message.text.strip().lower()
        
        def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç(—Ç–µ–∫—Å—Ç):
            bot.reply_to(message, —Ç–µ–∫—Å—Ç)
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—É "—Å—Ç–æ–ø"
        if —Ç–µ–∫—Å—Ç == "—Å—Ç–æ–ø":
            –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = False
            if user_id in –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞: 
                del –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
                –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = True
            elif user_id in –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞: 
                del –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞[user_id]
                –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = True
            elif user_id in –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π: 
                del –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π[user_id]
                –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = True
            elif user_id in –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏: 
                del –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
                –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = True
            elif user_id in –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥: 
                del –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id]
                –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ = True
            
            if –∏–≥—Ä–∞_–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –ò–≥—Ä–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –ù–∞–ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–≤–æ–π!")
            else:
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üëÆ: –¢—ã –Ω–µ –≤ –∏–≥—Ä–µ. –ù–∞–ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞!")
            return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã
        if user_id in –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞:
            if len(—Ç–µ–∫—Å—Ç) == 1 and —Ç–µ–∫—Å—Ç.isalpha():
                —Ä–µ–∑—É–ª—å—Ç–∞—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, —Ç–µ–∫—Å—Ç)
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç(—Ä–µ–∑—É–ª—å—Ç–∞—Ç)
            else:
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏ –æ–¥–Ω—É –±—É–∫–≤—É –∏–ª–∏ '—Å—Ç–æ–ø'")
            return
        elif user_id in –∏–≥—Ä—ã_—É–≥–∞–¥–∞–π–∫–∞:
            if —Ç–µ–∫—Å—Ç.isdigit():
                —Ä–µ–∑—É–ª—å—Ç–∞—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_—É–≥–∞–¥–∞–π–∫–∞(user_id, —Ç–µ–∫—Å—Ç)
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç(—Ä–µ–∑—É–ª—å—Ç–∞—Ç)
            else:
                –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("–í–≤–µ–¥–∏ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10 –∏–ª–∏ '—Å—Ç–æ–ø'")
            return
        elif user_id in –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π:
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∏–≥—Ä—ã –∏–ª–∏ –Ω–∞–ø–∏—à–∏ '—Å—Ç–æ–ø'")
            return
        elif user_id in –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏:
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∏–≥—Ä—ã –∏–ª–∏ –Ω–∞–ø–∏—à–∏ '—Å—Ç–æ–ø'")
            return
        elif user_id in –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥:
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∏–≥—Ä—ã –∏–ª–∏ –Ω–∞–ø–∏—à–∏ '—Å—Ç–æ–ø'")
            return
        
        # –û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        —Ä–µ–∑—É–ª—å—Ç–∞—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ(message.text, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç, –∑–∞–ø—É—Å—Ç–∏—Ç—å_–∏–≥—Ä—É=True)
        
        # –ó–∞–ø—É—Å–∫ –∏–≥—Ä
        if —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "hangman_start":
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üéÆ –í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å:\n\n1Ô∏è‚É£ –ª–µ–≥–∫–∏–π (7 –ø–æ–ø—ã—Ç–æ–∫)\n2Ô∏è‚É£ —Å—Ä–µ–¥–Ω–∏–π (5 –ø–æ–ø—ã—Ç–æ–∫)\n3Ô∏è‚É£ —Å–ª–æ–∂–Ω—ã–π (3 –ø–æ–ø—ã—Ç–∫–∏)\n\n–ù–∞–ø–∏—à–∏: –ª–µ–≥–∫–∏–π, —Å—Ä–µ–¥–Ω–∏–π –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–π")
        elif —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "guess_start":
            —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—É–≥–∞–¥–∞–π–∫–∞(user_id)
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("üéØ –Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10!\n–í–≤–µ–¥–∏ —Å–≤–æ—ë —á–∏—Å–ª–æ –∏–ª–∏ '—Å—Ç–æ–ø' –¥–ª—è –≤—ã—Ö–æ–¥–∞:")
        elif —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "sea_start":
            –∏–≥—Ä–∞ = —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–º–æ—Ä—Å–∫–æ–π_–±–æ–π(user_id)
            –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π[user_id] = –∏–≥—Ä–∞
            markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–º–æ—Ä—Å–∫–æ–π_–±–æ–π(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
            bot.reply_to(message, "üö¢ –ú–æ—Ä—Å–∫–æ–π –±–æ–π!\n–§–ª–æ—Ç: 1√ó3, 2√ó2, 3√ó1\n–ù–∞–∂–º–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É:", reply_markup=markup)
            return
        elif —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "tic_start":
            —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(user_id)
            –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
            markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
            bot.reply_to(message, "‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏!\n–¢—ã –∏–≥—Ä–∞–µ—à—å –∑–∞ ‚ùå\n–í—ã–±–µ—Ä–∏ –∫–ª–µ—Ç–∫—É:", reply_markup=markup)
            return
        elif —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "dino_start":
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç("ü¶ï –î–∏–Ω–æ - –ø—Ä–æ—Å—Ç–∞—è —Ç–µ–∫—Å—Ç–æ–≤–∞—è –∏–≥—Ä–∞, –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏.\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –∏–≥—Ä—ã!")
        elif —Ä–µ–∑—É–ª—å—Ç–∞—Ç == "match_start":
            import time
            –∏–≥—Ä–∞ = —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—Ç—Ä–∏_–≤_—Ä—è–¥(user_id)
            –∏–≥—Ä–∞['–≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞'] = time.time()
            –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id] = –∏–≥—Ä–∞
            markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
            bot.reply_to(message, —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã(–∏–≥—Ä–∞), reply_markup=markup)
            return
        else:
            # –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–∏ –∫–æ–º–∞–Ω–¥—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é
            import telebot
            markup = telebot.types.InlineKeyboardMarkup(row_width=2)
            
            games_row1 = [
                telebot.types.InlineKeyboardButton("üéØ –í–∏—Å–µ–ª–∏—Ü–∞", callback_data="menu_hangman"),
                telebot.types.InlineKeyboardButton("üé≤ –£–≥–∞–¥–∞–π–∫–∞", callback_data="menu_guess")
            ]
            games_row2 = [
                telebot.types.InlineKeyboardButton("üö¢ –ú–æ—Ä—Å–∫–æ–π –±–æ–π", callback_data="menu_sea"),
                telebot.types.InlineKeyboardButton("‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏", callback_data="menu_tic")
            ]
            games_row3 = [
                telebot.types.InlineKeyboardButton("üéØ –¢—Ä–∏ –≤ —Ä—è–¥", callback_data="menu_match"),
                telebot.types.InlineKeyboardButton("ü¶ï –î–∏–Ω–æ", callback_data="menu_dino")
            ]
            
            chat_row = [
                telebot.types.InlineKeyboardButton("üí¨ –ü–æ–±–æ–ª—Ç–∞—Ç—å", callback_data="menu_chat"),
                telebot.types.InlineKeyboardButton("üòÑ –ê–Ω–µ–∫–¥–æ—Ç", callback_data="menu_joke")
            ]
            
            markup.row(*games_row1)
            markup.row(*games_row2)
            markup.row(*games_row3)
            markup.row(*chat_row)
            
            bot.reply_to(message, "ü§î –ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å...\n\n"
                                  "üéÆ –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é:", reply_markup=markup)
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è –¥–ª—è –≤–∏—Å–µ–ª–∏—Ü—ã
        if —Ä–µ–∑—É–ª—å—Ç–∞—Ç is None and —Ç–µ–∫—Å—Ç in ["–ª–µ–≥–∫–∏–π", "—Å—Ä–µ–¥–Ω–∏–π", "—Å–ª–æ–∂–Ω—ã–π"] and user_id not in –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞:
            —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, —Ç–µ–∫—Å—Ç)
            –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
            —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f"–°–ª–æ–≤–æ: {' '.join(–∏–≥—Ä–∞['—É–≥–∞–¥–∞–Ω–æ'])}\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}"
            –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–æ—Ç–≤–µ—Ç(f"üéØ –ò–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\n–í–≤–µ–¥–∏ –±—É–∫–≤—É –∏–ª–∏ '—Å—Ç–æ–ø':")
    
    @bot.callback_query_handler(func=lambda call: True)
    def handle_callback(call):
        user_id = call.from_user.id
        data = call.data
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–Ω—é
        if data.startswith("menu_"):
            if data == "menu_hangman":
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Ä–æ–≤–Ω–∏ –¥–ª—è –≤–∏—Å–µ–ª–∏—Ü—ã
                import telebot
                markup = telebot.types.InlineKeyboardMarkup(row_width=1)
                markup.row(telebot.types.InlineKeyboardButton("üü¢ –õ–µ–≥–∫–∏–π (7 –ø–æ–ø—ã—Ç–æ–∫)", callback_data="level_easy"))
                markup.row(telebot.types.InlineKeyboardButton("üü° –°—Ä–µ–¥–Ω–∏–π (5 –ø–æ–ø—ã—Ç–æ–∫)", callback_data="level_medium"))
                markup.row(telebot.types.InlineKeyboardButton("üî¥ –°–ª–æ–∂–Ω—ã–π (3 –ø–æ–ø—ã—Ç–∫–∏)", callback_data="level_hard"))
                markup.row(telebot.types.InlineKeyboardButton("üîô –ù–∞–∑–∞–¥", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("üéØ **–í–∏—Å–µ–ª–∏—Ü–∞**\n\n"
                                          "–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:\n\n"
                                          "üü¢ **–õ–µ–≥–∫–∏–π** - 7 –ø–æ–ø—ã—Ç–æ–∫, –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–∞\n"
                                          "üü° **–°—Ä–µ–¥–Ω–∏–π** - 5 –ø–æ–ø—ã—Ç–æ–∫, –æ–±—ã—á–Ω—ã–µ —Å–ª–æ–≤–∞\n"
                                          "üî¥ **–°–ª–æ–∂–Ω—ã–π** - 3 –ø–æ–ø—ã—Ç–∫–∏, —Å–ª–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_guess":
                # –ó–∞–ø—É—Å–∫–∞–µ–º —É–≥–∞–¥–∞–π–∫—É
                —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—É–≥–∞–¥–∞–π–∫–∞(user_id)
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("üé≤ **–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ**\n\n"
                                          "–Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10!\n\n"
                                          "üí° –í–≤–µ–¥–∏ —Å–≤–æ—ë —á–∏—Å–ª–æ –≤ —á–∞—Ç –∏–ª–∏ –Ω–∞–∂–º–∏ '—Å—Ç–æ–ø' –¥–ª—è –≤—ã—Ö–æ–¥–∞", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_sea":
                # –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ—Ä—Å–∫–æ–π –±–æ–π
                –∏–≥—Ä–∞ = —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–º–æ—Ä—Å–∫–æ–π_–±–æ–π(user_id)
                –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π[user_id] = –∏–≥—Ä–∞
                markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–º–æ—Ä—Å–∫–æ–π_–±–æ–π(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                
                try:
                    bot.edit_message_text("üö¢ **–ú–æ—Ä—Å–∫–æ–π –±–æ–π**\n\n"
                                          "–§–ª–æ—Ç: 1√ó3, 2√ó2, 3√ó1\n"
                                          "–ù–∞–∂–º–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É –¥–ª—è –≤—ã—Å—Ç—Ä–µ–ª–∞!", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_tic":
                # –ó–∞–ø—É—Å–∫–∞–µ–º –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
                —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(user_id)
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏[user_id]
                markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                
                try:
                    bot.edit_message_text("‚ùå‚≠ï **–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏**\n\n"
                                          "–¢—ã –∏–≥—Ä–∞–µ—à—å –∑–∞ ‚ùå\n"
                                          "–í—ã–±–µ—Ä–∏ –∫–ª–µ—Ç–∫—É –¥–ª—è —Ö–æ–¥–∞!", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_match":
                # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç—Ä–∏ –≤ —Ä—è–¥
                import time
                
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã
                from database import db
                db.save_user(
                    user_id,
                    username=call.from_user.username,
                    first_name=call.from_user.first_name,
                    last_name=call.from_user.last_name
                )
                
                –∏–≥—Ä–∞ = —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—Ç—Ä–∏_–≤_—Ä—è–¥(user_id)
                –∏–≥—Ä–∞['–≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞'] = time.time()
                –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id] = –∏–≥—Ä–∞
                markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                
                try:
                    bot.edit_message_text(—Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã(–∏–≥—Ä–∞), 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_dino":
                # –î–∏–Ω–æ –∏–≥—Ä–∞
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("ü¶ï **–î–∏–Ω–æ**\n\n"
                                          "–≠—Ç–æ –ø—Ä–æ—Å—Ç–∞—è —Ç–µ–∫—Å—Ç–æ–≤–∞—è –∏–≥—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏.\n\n"
                                          "üéÆ –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–∏–µ –∏–≥—Ä—ã –∏–∑ –º–µ–Ω—é!", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_chat":
                # –û–±—â–µ–Ω–∏–µ
                import telebot
                markup = telebot.types.InlineKeyboardMarkup(row_width=2)
                chat_buttons = [
                    telebot.types.InlineKeyboardButton("üëã –ü—Ä–∏–≤–µ—Ç", callback_data="chat_hello"),
                    telebot.types.InlineKeyboardButton("üòä –ö–∞–∫ –¥–µ–ª–∞?", callback_data="chat_how_are_you"),
                    telebot.types.InlineKeyboardButton("ü§î –ö—Ç–æ —Ç—ã?", callback_data="chat_who_are_you"),
                    telebot.types.InlineKeyboardButton("üí≠ –†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ", callback_data="chat_about"),
                    telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back")
                ]
                markup.row(chat_buttons[0], chat_buttons[1])
                markup.row(chat_buttons[2], chat_buttons[3])
                markup.row(chat_buttons[4])
                
                try:
                    bot.edit_message_text("üí¨ **–û–±—â–µ–Ω–∏–µ**\n\n"
                                          "–ü—Ä–∏–≤–µ—Ç! –î–∞–≤–∞–π –ø–æ–±–æ–ª—Ç–∞–µ–º! üòä\n\n"
                                          "–í—ã–±–µ—Ä–∏ —Ç–µ–º—É –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞:", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_joke":
                # –ê–Ω–µ–∫–¥–æ—Ç
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üòÑ –ï—â—ë –∞–Ω–µ–∫–¥–æ—Ç", callback_data="menu_joke"))
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                –∞–Ω–µ–∫–¥–æ—Ç—ã = [
                    "‚Äî –ß—Ç–æ —Å–∫–∞–∑–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –Ω–∞ —Å–≤–∏–¥–∞–Ω–∏–∏?\n‚Äî –£ –º–µ–Ω—è \"404: —á—É–≤—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ\".",
                    "‚Äî –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—É—Ç–∞—é—Ç –†–æ–∂–¥–µ—Å—Ç–≤–æ –∏ –•—ç–ª–ª–æ—É–∏–Ω?\n‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ Oct 31 == Dec 25",
                    "‚Äî –ö–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ª–æ–º–∞–µ—Ç –≥–æ–ª–æ–≤—É?\n‚Äî Git push --force",
                    "‚Äî –ß—Ç–æ —Å–∫–∞–∑–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, –∫–æ–≥–¥–∞ —É–ø–∞–ª —Å –ª–µ—Å—Ç–Ω–∏—Ü—ã?\n‚Äî –û—à–∏–±–∫–∞ 500: Internal Server Error",
                    "‚Äî –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –Ω–µ –ª—é–±—è—Ç –ø—Ä–∏—Ä–æ–¥—É?\n‚Äî –¢–∞–º —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –±–∞–≥–æ–≤"
                ]
                import random
                –∞–Ω–µ–∫–¥–æ—Ç = random.choice(–∞–Ω–µ–∫–¥–æ—Ç—ã)
                
                try:
                    bot.edit_message_text(f"üòÑ **–ê–Ω–µ–∫–¥–æ—Ç**\n\n{–∞–Ω–µ–∫–¥–æ—Ç}", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "menu_leaderboard":
                # –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
                try:
                    –ª–∏–¥–µ—Ä—ã = –ø–æ–ª—É—á–∏—Ç—å_—Ç–∞–±–ª–∏—Ü—É_–ª–∏–¥–µ—Ä–æ–≤(10)
                    –ø–æ–∑–∏—Ü–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = –ø–æ–ª—É—á–∏—Ç—å_–ø–æ–∑–∏—Ü–∏—é_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(user_id)
                    —Ç–µ–∫—Å—Ç_–ª–∏–¥–µ—Ä–æ–≤ = —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Ç–∞–±–ª–∏—Ü—ã_–ª–∏–¥–µ—Ä–æ–≤(–ª–∏–¥–µ—Ä—ã, –ø–æ–∑–∏—Ü–∏—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
                    
                    import telebot
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.row(telebot.types.InlineKeyboardButton("üîÑ –û–±–Ω–æ–≤–∏—Ç—å", callback_data="menu_leaderboard"))
                    markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                    
                    bot.edit_message_text(—Ç–µ–∫—Å—Ç_–ª–∏–¥–µ—Ä–æ–≤, call.message.chat.id, call.message.message_id, reply_markup=markup)
                except Exception as e:
                    import telebot
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                    
                    bot.edit_message_text(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤: {str(e)}", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                    
            elif data == "menu_stats":
                # –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                try:
                    from database import db
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    db.save_user(user_id, 
                                username=call.from_user.username,
                                first_name=call.from_user.first_name,
                                last_name=call.from_user.last_name)
                    
                    # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    stats = db.get_user_stats(user_id, "—Ç—Ä–∏_–≤_—Ä—è–¥")
                    achievements = db.get_user_achievements(user_id, "—Ç—Ä–∏_–≤_—Ä—è–¥")
                    
                    if stats:
                        —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ = f"üìä **–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –¢—Ä–∏ –≤ —Ä—è–¥**\n\n" \
                                          f"üéÆ –ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ: {stats['games_played']}\n" \
                                          f"üèÜ –õ—É—á—à–∏–π —Å—á—ë—Ç: {stats['best_score']}\n" \
                                          f"üìà –°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç: {stats['avg_score']}\n" \
                                          f"üéØ –í—Å–µ–≥–æ —Ö–æ–¥–æ–≤: {stats['total_moves']}\n" \
                                          f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {stats['total_time']} —Å–µ–∫"
                        
                        if achievements:
                            —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ += f"\n\nüèÖ **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**\n" + "\n".join(achievements)
                        else:
                            —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ += "\n\nüèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è: –ø–æ–∫–∞ –Ω–µ—Ç"
                    else:
                        —Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ = "üìä **–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –¢—Ä–∏ –≤ —Ä—è–¥**\n\n" \
                                          "üéÆ –¢—ã –µ—â—ë –Ω–µ –∏–≥—Ä–∞–ª –≤ —ç—Ç—É –∏–≥—Ä—É!\n" \
                                          "üéØ –ü–æ–ø—Ä–æ–±—É–π —Å—ã–≥—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–æ—Ä–¥!"
                    
                    import telebot
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.row(telebot.types.InlineKeyboardButton("üéØ –ò–≥—Ä–∞—Ç—å", callback_data="menu_match"))
                    markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                    
                    bot.edit_message_text(—Ç–µ–∫—Å—Ç_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, call.message.chat.id, call.message.message_id, reply_markup=markup)
                except Exception as e:
                    import telebot
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                    
                    bot.edit_message_text(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {str(e)}", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                    
            elif data == "menu_back":
                # –í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
                import telebot
                markup = telebot.types.InlineKeyboardMarkup(row_width=2)
                
                games_row1 = [
                    telebot.types.InlineKeyboardButton("üéØ –í–∏—Å–µ–ª–∏—Ü–∞", callback_data="menu_hangman"),
                    telebot.types.InlineKeyboardButton("üé≤ –£–≥–∞–¥–∞–π–∫–∞", callback_data="menu_guess")
                ]
                games_row2 = [
                    telebot.types.InlineKeyboardButton("üö¢ –ú–æ—Ä—Å–∫–æ–π –±–æ–π", callback_data="menu_sea"),
                    telebot.types.InlineKeyboardButton("‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏", callback_data="menu_tic")
                ]
                games_row3 = [
                    telebot.types.InlineKeyboardButton("üéØ –¢—Ä–∏ –≤ —Ä—è–¥", callback_data="menu_match"),
                    telebot.types.InlineKeyboardButton("ü¶ï –î–∏–Ω–æ", callback_data="menu_dino")
                ]
                
                chat_row = [
                    telebot.types.InlineKeyboardButton("üí¨ –ü–æ–±–æ–ª—Ç–∞—Ç—å", callback_data="menu_chat"),
                    telebot.types.InlineKeyboardButton("üòÑ –ê–Ω–µ–∫–¥–æ—Ç", callback_data="menu_joke")
                ]
                
                stats_row = [
                    telebot.types.InlineKeyboardButton("üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤", callback_data="menu_leaderboard"),
                    telebot.types.InlineKeyboardButton("üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", callback_data="menu_stats")
                ]
                
                markup.row(*games_row1)
                markup.row(*games_row2)
                markup.row(*games_row3)
                markup.row(*chat_row)
                markup.row(*stats_row)
                
                try:
                    bot.edit_message_text("üéÆ **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**\n\n"
                                          "–í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ:", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Ä–æ–≤–Ω–µ–π –≤–∏—Å–µ–ª–∏—Ü—ã
        elif data.startswith("level_"):
            if data == "level_easy":
                —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, "–ª–µ–≥–∫–∏–π")
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
                —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f"–°–ª–æ–≤–æ: {' '.join(–∏–≥—Ä–∞['—É–≥–∞–¥–∞–Ω–æ'])}\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}"
                
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text(f"üéØ **–í–∏—Å–µ–ª–∏—Ü–∞ - –õ–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å**\n\n"
                                          f"–ò–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\n"
                                          f"üí° –í–≤–µ–¥–∏ –±—É–∫–≤—É –≤ —á–∞—Ç –∏–ª–∏ '—Å—Ç–æ–ø' –¥–ª—è –≤—ã—Ö–æ–¥–∞", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "level_medium":
                —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, "—Å—Ä–µ–¥–Ω–∏–π")
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
                —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f"–°–ª–æ–≤–æ: {' '.join(–∏–≥—Ä–∞['—É–≥–∞–¥–∞–Ω–æ'])}\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}"
                
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text(f"üéØ **–í–∏—Å–µ–ª–∏—Ü–∞ - –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å**\n\n"
                                          f"–ò–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\n"
                                          f"üí° –í–≤–µ–¥–∏ –±—É–∫–≤—É –≤ —á–∞—Ç –∏–ª–∏ '—Å—Ç–æ–ø' –¥–ª—è –≤—ã—Ö–æ–¥–∞", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "level_hard":
                —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_–≤–∏—Å–µ–ª–∏—Ü–∞(user_id, "—Å–ª–æ–∂–Ω—ã–π")
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–≤–∏—Å–µ–ª–∏—Ü–∞[user_id]
                —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f"–°–ª–æ–≤–æ: {' '.join(–∏–≥—Ä–∞['—É–≥–∞–¥–∞–Ω–æ'])}\n–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {–∏–≥—Ä–∞['–ø–æ–ø—ã—Ç–∫–∏']}"
                
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text(f"üéØ **–í–∏—Å–µ–ª–∏—Ü–∞ - –°–ª–æ–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å**\n\n"
                                          f"–ò–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞!\n{—Å–æ—Å—Ç–æ—è–Ω–∏–µ}\n\n"
                                          f"üí° –í–≤–µ–¥–∏ –±—É–∫–≤—É –≤ —á–∞—Ç –∏–ª–∏ '—Å—Ç–æ–ø' –¥–ª—è –≤—ã—Ö–æ–¥–∞", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Ç–∞
        elif data.startswith("chat_"):
            if data == "chat_hello":
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("üëã **–ü—Ä–∏–≤–µ—Ç!**\n\n"
                                          "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! üòä\n\n"
                                          "–Ø —Ç–≤–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –∏ –∏–≥—Ä–æ–≤–æ–π –±–æ—Ç. "
                                          "–ú–æ–≥—É –∏–≥—Ä–∞—Ç—å —Å —Ç–æ–±–æ–π –≤ —Ä–∞–∑–Ω—ã–µ –∏–≥—Ä—ã, –±–æ–ª—Ç–∞—Ç—å –∏ –¥–∞–∂–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –∞–Ω–µ–∫–¥–æ—Ç—ã! üéÆ", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "chat_how_are_you":
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("üòä **–ö–∞–∫ –¥–µ–ª–∞?**\n\n"
                                          "–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –Ø –≤ —Ä–µ–∂–∏–º–µ –æ–Ω–ª–∞–π–Ω –∏ –≥–æ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å! üöÄ\n\n"
                                          "–ê —É —Ç–µ–±—è –∫–∞–∫ –¥–µ–ª–∞? –ù–∞–¥–µ—é—Å—å, —Ç–æ–∂–µ —Ö–æ—Ä–æ—à–æ! üòÑ", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "chat_who_are_you":
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("ü§ñ **–ö—Ç–æ —è?**\n\n"
                                          "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ü–æ–º–æ—â–Ω–∏–∫! üëÆ\n\n"
                                          "–Ø –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫ –∏ –∏–≥—Ä–æ–≤–æ–π –±–æ—Ç. "
                                          "–£–º–µ—é –∏–≥—Ä–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã–µ –∏–≥—Ä—ã, –æ–±—â–∞—Ç—å—Å—è –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç—å! "
                                          "–°–æ–∑–¥–∞–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Ç–≤–æ—ë –≤—Ä–µ–º—è –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º! üéØ", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
                    
            elif data == "chat_about":
                import telebot
                markup = telebot.types.InlineKeyboardMarkup()
                markup.row(telebot.types.InlineKeyboardButton("üîô –í –º–µ–Ω—é", callback_data="menu_back"))
                
                try:
                    bot.edit_message_text("üí≠ **–û —Å–µ–±–µ**\n\n"
                                          "–Ø - –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è –æ–±—â–µ–Ω–∏—è –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π! ü§ñ\n\n"
                                          "**–ß—Ç–æ —è —É–º–µ—é:**\n"
                                          "üéÆ –ò–≥—Ä–∞—Ç—å –≤ 6 —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä\n"
                                          "üí¨ –û–±—â–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã\n"
                                          "üòÑ –†–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –∞–Ω–µ–∫–¥–æ—Ç—ã\n"
                                          "üéØ –ü–æ–º–æ–≥–∞—Ç—å –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç—å\n\n"
                                          "–ú–æ—è —Ü–µ–ª—å - —Å–¥–µ–ª–∞—Ç—å —Ç–≤–æ—ë –≤—Ä–µ–º—è –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º! ‚ú®", 
                                          call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    pass
        
        elif data.startswith("sea_"):
            if user_id in –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π:
                _, x, y = data.split("_")
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π[user_id]
                markup, —Ç–µ–∫—Å—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–º–æ—Ä—Å–∫–æ–π_–±–æ–π(–∏–≥—Ä–∞, int(x), int(y))
                if markup:
                    try:
                        bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                    except:
                        pass
                else:
                    del –∏–≥—Ä—ã_–º–æ—Ä—Å–∫–æ–π_–±–æ–π[user_id]
                    try:
                        bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id)
                    except:
                        pass

        
        elif data.startswith("tic_"):
            if user_id in –∏–≥—Ä—ã_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏:
                _, x, y = data.split("_")
                markup, —Ç–µ–∫—Å—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_–∫—Ä–µ—Å—Ç–∏–∫–∏_–Ω–æ–ª–∏–∫–∏(user_id, int(x), int(y))
                if markup:
                    try:
                        bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                    except:
                        pass
                else:
                    try:
                        bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id)
                    except:
                        pass
        
        elif data.startswith("match_"):
            if user_id in –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥:
                –∏–≥—Ä–∞ = –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id]
                
                # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
                if data == "match_cancel":
                    –∏–≥—Ä–∞['–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞'] = None
                    markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                    try:
                        bot.edit_message_text(—Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã(–∏–≥—Ä–∞), call.message.chat.id, call.message.message_id, reply_markup=markup)
                    except:
                        pass
                elif data == "match_end":
                    # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
                    —Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç = —Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞(–∏–≥—Ä–∞)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                    try:
                        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                        from database import db
                        db.save_user(
                            user_id,
                            username=call.from_user.username,
                            first_name=call.from_user.first_name,
                            last_name=call.from_user.last_name
                        )
                        
                        is_personal_record, is_global_record, achievements = —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å_—Ä–µ–∑—É–ª—å—Ç–∞—Ç_–≤_–±–¥(user_id, –∏–≥—Ä–∞)
                        
                        # –î–æ–±–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∫–æ—Ä–¥–∞—Ö
                        —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è = ""
                        if is_global_record:
                            —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è += "\n\nüèÜüéâ **–ù–û–í–´–ô –ú–ò–†–û–í–û–ô –†–ï–ö–û–†–î!** üéâüèÜ"
                        elif is_personal_record:
                            —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è += "\n\nü•á **–ù–æ–≤—ã–π –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥!** ü•á"
                        
                        # –î–æ–±–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö
                        if achievements:
                            —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è += "\n\nüèÖ **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**\n" + "\n".join(achievements)
                        
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤
                        –ø–æ–∑–∏—Ü–∏—è = –ø–æ–ª—É—á–∏—Ç—å_–ø–æ–∑–∏—Ü–∏—é_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(user_id)
                        if –ø–æ–∑–∏—Ü–∏—è == 1:
                            —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è += "\n\nüëë **–¢—ã –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ!** üëë"
                        elif –ø–æ–∑–∏—Ü–∏—è and –ø–æ–∑–∏—Ü–∏—è <= 3:
                            —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è += f"\n\nü•â **–¢—ã –≤ —Ç–æ–ø-{–ø–æ–∑–∏—Ü–∏—è}!** ü•â"
                        
                        —Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç += —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        
                    except Exception as e:
                        —Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç += f"\n\n‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: {str(e)}"
                    
                    # –°–æ–∑–¥–∞—ë–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
                    import telebot
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.row(telebot.types.InlineKeyboardButton("üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤", 
                                                                callback_data="menu_leaderboard"))
                    markup.row(telebot.types.InlineKeyboardButton("üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º", 
                                                                callback_data="match_share"))
                    markup.row(telebot.types.InlineKeyboardButton("üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞", 
                                                                callback_data="match_new"))
                    
                    del –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id]
                    try:
                        bot.edit_message_text(—Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                    except:
                        pass
                elif data == "match_share":
                    # –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
                    try:
                        –ø–æ–∑–∏—Ü–∏—è = –ø–æ–ª—É—á–∏—Ç—å_–ø–æ–∑–∏—Ü–∏—é_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(user_id)
                        –ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç = ""
                        if –ø–æ–∑–∏—Ü–∏—è:
                            if –ø–æ–∑–∏—Ü–∏—è == 1:
                                –ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç = "ü•á **1 –º–µ—Å—Ç–æ!**"
                            elif –ø–æ–∑–∏—Ü–∏—è == 2:
                                –ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç = "ü•à **2 –º–µ—Å—Ç–æ!**"
                            elif –ø–æ–∑–∏—Ü–∏—è == 3:
                                –ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç = "ü•â **3 –º–µ—Å—Ç–æ!**"
                            else:
                                –ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç = f"#{–ø–æ–∑–∏—Ü–∏—è} –º–µ—Å—Ç–æ"
                        
                        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞
                        if call.from_user.username:
                            –∏–º—è_–∏–≥—Ä–æ–∫–∞ = f"@{call.from_user.username}"
                        elif call.from_user.first_name:
                            –∏–º—è_–∏–≥—Ä–æ–∫–∞ = call.from_user.first_name
                        else:
                            –∏–º—è_–∏–≥—Ä–æ–∫–∞ = "–ò–≥—Ä–æ–∫"
                        
                        —Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç = f"üéÆ **–¢—Ä–∏ –≤ —Ä—è–¥ - –†–µ–∑—É–ª—å—Ç–∞—Ç!**\n\n" \
                                         f"üë§ –ò–≥—Ä–æ–∫: {–∏–º—è_–∏–≥—Ä–æ–∫–∞}\n" \
                                         f"üìä –°—á—ë—Ç: {–∏–≥—Ä–∞['—Å—á—ë—Ç']}\n" \
                                         f"üéØ –•–æ–¥—ã: {–∏–≥—Ä–∞['—Ö–æ–¥—ã']}\n" \
                                         f"‚è±Ô∏è –í—Ä–µ–º—è: {–∏–≥—Ä–∞['–æ–±—â–µ–µ_–≤—Ä–µ–º—è']} —Å–µ–∫\n" \
                                         f"üî• –ú–∞–∫—Å. –∫–æ–º–±–æ: x{–∏–≥—Ä–∞['–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ_–∫–æ–º–±–æ']}\n\n" \
                                         f"üèÜ {–ø–æ–∑–∏—Ü–∏—è_—Ç–µ–∫—Å—Ç}\n\n" \
                                         f"üé≤ –ü–æ–ø—Ä–æ–±—É–π —Å—ã–≥—Ä–∞—Ç—å —Å–∞–º!"
                    except:
                        —Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç = f"üéÆ **–¢—Ä–∏ –≤ —Ä—è–¥ - –†–µ–∑—É–ª—å—Ç–∞—Ç!**\n\n" \
                                         f"üìä –°—á—ë—Ç: {–∏–≥—Ä–∞['—Å—á—ë—Ç']}\n" \
                                         f"üéØ –•–æ–¥—ã: {–∏–≥—Ä–∞['—Ö–æ–¥—ã']}\n\n" \
                                         f"üé≤ –ü–æ–ø—Ä–æ–±—É–π —Å—ã–≥—Ä–∞—Ç—å —Å–∞–º!"
                    
                    try:
                        bot.edit_message_text(—Ä–µ–∑—É–ª—å—Ç–∞—Ç_—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id)
                    except:
                        pass
                elif data == "match_new":
                    # –ù–æ–≤–∞—è –∏–≥—Ä–∞
                    import time
                    –Ω–æ–≤–∞—è_–∏–≥—Ä–∞ = —Å–æ–∑–¥–∞—Ç—å_–∏–≥—Ä—É_—Ç—Ä–∏_–≤_—Ä—è–¥(user_id)
                    –Ω–æ–≤–∞—è_–∏–≥—Ä–∞['–≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞'] = time.time()
                    –∏–≥—Ä—ã_—Ç—Ä–∏_–≤_—Ä—è–¥[user_id] = –Ω–æ–≤–∞—è_–∏–≥—Ä–∞
                    markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥(–Ω–æ–≤–∞—è_–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                    try:
                        bot.edit_message_text(—Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã(–Ω–æ–≤–∞—è_–∏–≥—Ä–∞), call.message.chat.id, call.message.message_id, reply_markup=markup)
                    except:
                        pass
                else:
                    # –û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞
                    _, x, y = data.split("_")
                    
                    # –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä –∫–ª–µ—Ç–∫–∏ –∏–ª–∏ –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π
                    if not –∏–≥—Ä–∞.get('–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞'):
                        markup, —Ç–µ–∫—Å—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞, int(x), int(y))
                        if markup:
                            try:
                                bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                            except:
                                pass
                        else:
                            –∏–≥—Ä–∞['–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞'] = None
                            try:
                                bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id)
                            except:
                                pass
                    else:
                        # –í—Ç–æ—Ä–æ–π –≤—ã–±–æ—Ä - –æ–±–º–µ–Ω –∫–ª–µ—Ç–æ–∫
                        x1, y1 = –∏–≥—Ä–∞['–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞']
                        x2, y2 = int(x), int(y)
                        
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–µ—Ç–∫–∏ —Å–æ—Å–µ–¥–Ω–∏–µ
                        if abs(x1 - x2) + abs(y1 - y2) == 1:
                            —É—Å–ø–µ—Ö, —Ç–µ–∫—Å—Ç = –æ–±–º–µ–Ω_–∫–ª–µ—Ç–æ–∫(–∏–≥—Ä–∞, x1, y1, x2, y2)
                            –∏–≥—Ä–∞['–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞'] = None
                            
                            markup = —Å–æ–∑–¥–∞—Ç—å_–∫–Ω–æ–ø–∫–∏_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞['–ø–æ–ª–µ'])
                            –Ω–æ–≤—ã–π_—Ç–µ–∫—Å—Ç = f"{—Ç–µ–∫—Å—Ç}\n\n{—Å–æ–∑–¥–∞—Ç—å_—Ç–µ–∫—Å—Ç_–∏–≥—Ä—ã(–∏–≥—Ä–∞)}"
                            
                            try:
                                bot.edit_message_text(–Ω–æ–≤—ã–π_—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                            except:
                                pass
                        else:
                            # –ù–µ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏ - –≤—ã–±–∏—Ä–∞–µ–º –Ω–æ–≤—É—é
                            markup, —Ç–µ–∫—Å—Ç = –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Ö–æ–¥_—Ç—Ä–∏_–≤_—Ä—è–¥(–∏–≥—Ä–∞, x2, y2)
                            if markup:
                                try:
                                    bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id, reply_markup=markup)
                                except:
                                    pass
                            else:
                                –∏–≥—Ä–∞['–≤—ã–±—Ä–∞–Ω–Ω–∞—è_–∫–ª–µ—Ç–∫–∞'] = None
                                try:
                                    bot.edit_message_text(—Ç–µ–∫—Å—Ç, call.message.chat.id, call.message.message_id)
                                except:
                                    pass
        
        bot.answer_callback_query(call.id)

    print("ü§ñ Telegram –±–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    print("üì± –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –∏ –Ω–∞–ø–∏—à–∏—Ç–µ /start")
    bot.polling()
    return True

# –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞
if __name__ == "__main__":
    try:
        –∑–∞–ø—É—Å—Ç–∏—Ç—å_–±–æ—Ç–∞()
    except KeyboardInterrupt:
        print("\nüëÆ: –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")